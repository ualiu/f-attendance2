<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %> - Felton Brushes</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <%- include('../partials/header') %>
  <%- include('../partials/sidebar') %>

  <main class="main-with-sidebar">
    <h1>Employee Report: <%= report.employee.name %></h1>
    <p class="report-meta">
      Period: <%= new Date(startDate).toLocaleDateString() %> - <%= new Date(endDate).toLocaleDateString() %>
      | Generated: <%= report.generated_at.toLocaleString() %>
    </p>

    <div class="report-section">
      <h2>Employee Information</h2>
      <div class="info-grid">
        <div><strong>Employee ID:</strong> <%= report.employee.employee_id %></div>
        <div><strong>Department:</strong> <%= report.employee.department %></div>
        <div><strong>Work Station:</strong> <%= report.employee.work_station || 'Not assigned' %></div>
        <div><strong>Shift:</strong> <%= report.employee.shift %></div>
        <div><strong>Current Points:</strong> <%= report.employee.points_current_quarter %> / 6.0</div>
        <div><strong>Status:</strong>
          <span class="status-badge status-<%= report.employee.status %>">
            <%= report.employee.status.replace('_', ' ') %>
          </span>
        </div>
      </div>
    </div>

    <div class="report-section">
      <h2>Absences Summary</h2>
      <p><strong>Total Absences:</strong> <%= report.absences.length %></p>
      <ul style="margin-top: 1rem;">
        <% report.absences.forEach(absence => { %>
          <li>
            <%= new Date(absence.date).toLocaleDateString() %>:
            <%= absence.type %> - <%= absence.reason %>
            (<%= absence.points_awarded %> points)
          </li>
        <% }); %>
      </ul>
    </div>

    <div class="report-section ai-analysis">
      <h2>AI Analysis by Claude</h2>
      <div class="analysis-content">
        <%= report.analysis %>
      </div>
    </div>

    <div class="report-actions">
      <button onclick="window.print()" class="btn btn-primary">Print Report</button>
      <a href="/reports" class="btn btn-secondary">Generate Another Report</a>
      <a href="/dashboard/employee/<%= report.employee._id %>" class="btn btn-secondary">View Employee</a>
    </div>
  </main>

  <style>
    .report-meta {
      color: #666;
      margin-bottom: 2rem;
    }
    .report-section {
      background: white;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    .ai-analysis {
      border-left: 4px solid #0066cc;
    }
    .analysis-content {
      white-space: pre-wrap;
      line-height: 1.8;
      color: #333;
    }
    .report-actions {
      display: flex;
      gap: 1rem;
      margin-top: 2rem;
    }
    @media print {
      .header, .sidebar, .report-actions {
        display: none;
      }
      .main-with-sidebar {
        margin-left: 0;
      }
    }
  </style>
</body>
</html>
